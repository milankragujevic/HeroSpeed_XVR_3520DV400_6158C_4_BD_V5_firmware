var osdVariables={totalChannelNum:getTotalChannelNum(),channelArray:new Array(getTotalChannelNum()),channelOsdEnable:false};function onLoad(){initDot();setTitle(lang.osdOpt);initOsd();getChannalIsProtocolPrivate()}function initOsd(){$("#videoBlock").isPlayer({isConfigVideo:true});$(".J-time, .J-osd-text").prop("disabled","disabled");if(checkPluginInstall()){var b=$("#videoBlock");b.isPlayer("setPlayWindowNum",2,0);b.isPlayer("initVideoWindow",getDeviceValue()).isPlayer("stopAllVideo");b.isPlayer("setWindowType",DEFAULT_WINDOW)}$(".J-osd-save").on("click",onSaveOsd);$(".J-enable-time").change(function(){$(".J-time").prop("disabled",!$(".J-enable-time").is(":checked"))});$(".J-enable-name").change(function(){$(".J-osd-text").prop("disabled",!$(".J-enable-name").is(":checked"))});$(".J-osd-text").bind("keydown keyup blur",function(){checkStringValid($(".J-osd-text").val(),this,!isXVR()?1:0)});var a=0;$(".J-osd-channel").change(function(){var c=$(this).data("lastPlayCh");var e=$("#videoBlock");var f=parseInt($(this).val());var d=f==0?0:f;c!==undefined&&e.isPlayer("stopPreview",c);$(this).data("lastPlayCh",f);if(nLiveviewDatabit[d]&&checkPluginInstall()){e.isPlayer("setHttpPort").isPlayer("startPreview",1,f)}else{$("#videoBlock>.J-plugin-block").html("");var g=function(){configPurePlay(f,null,c,a);a++};getPlayEncodeInfo(f,g,true)}loadOsd(parseInt($(this).val()))})}function onUnload(){var a=$("#videoBlock");var b=$(".J-osd-channel").data("lastPlayCh");b!==undefined&&a.isPlayer("stopPreview",b);a.isPlayer("destroy")}function loadOsd(a){a||(a=0);api.osd(REQUEST_GET,{channel:a},function(b,c){if(b!=CODE_SUCCESS){return}autoFillValue("osd",c)})}function getChannalIsProtocolPrivate(){for(var a=0;a<osdVariables.totalChannelNum;a++){osdVariables.channelArray[a]=0}getChannelProtocolType(function(){initChannelSelect($(".J-osd-channel"),osdVariables.totalChannelNum,function(b){return xvrChannelConfig.osdAndPrivacy[b]==b});osdVariables.channelOsdEnable=$(".J-osd-channel").val()?true:false;osdVariables.channelOsdEnable?$(".J-osd-channel").change():rightPopup(lang.nolimit)})}function onSaveOsd(){if(!osdVariables.channelOsdEnable){return rightPopup(lang.nolimit)}var a=getMatchValue("osd");a.channel=parseInt($(".J-osd-channel").val());api.osd(REQUEST_SET,a,function(b){rightPopup(b==CODE_SUCCESS?lang.saved:lang.savedfail)})};